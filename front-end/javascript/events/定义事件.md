ä¹‹å‰çŸ¥é“å®šä¹‰äº‹ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰è®¤çœŸçš„å»å­¦ä¹ å¯¹åº”çš„apiåŠç”¨æ³•ã€‚è¶ç€æƒ³åˆ°äº†è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œæ¥æ¢³ç†ä¸‹ã€‚

### Event

ä»€ä¹ˆæ˜¯`Event`ï¼Ÿå°±æ˜¯è¡¨ç¤ºåœ¨DOMä¸­å‘ç”Ÿçš„äº‹ä»¶ã€‚

æˆ‘ä»¬çŸ¥é“äº‹ä»¶å¯ä»¥è¢«ç”¨æˆ·çš„é¼ æ ‡ç‚¹å‡»çš„ç±»ä¼¼æ“ä½œç»™è§¦å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç¨‹åºçš„`HTMLElement.click()`ç±»ä¼¼çš„æ–¹å¼æ¥è§¦å‘ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰äº‹ä»¶ï¼Œç„¶åé€šè¿‡[`EventTarget.dispatchEvent()`](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent)æ¥è§¦å‘ã€‚

è¦åˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œé¦–å…ˆå¯ä»¥æ ¹æ®[`Event`](https://developer.mozilla.org/en-US/docs/Web/API/Event)æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªäº‹ä»¶ã€‚

```js
var event = new Event('build');

elem.addEventListener('build', function (e) { /* ... */ }, false);

// åŒ¹é…äº‹ä»¶.
elem.dispatchEvent(event);
```
è¿™ä¸ªå…¼å®¹æ€§ä¹Ÿè¿˜è¡Œï¼Œæ”¯æŒå¤§å¤šæ•°çš„ç°ä»£æ€§çš„æµè§ˆå™¨ï¼Œå½“ç„¶äº†ï¼ŒIEä¸æ”¯æŒã€‚è¦æƒ³ä½¿ç”¨IEæ”¯æŒï¼Œå°±è¦ä½¿ç”¨åé¢æåˆ°çš„è€å¼çš„æ–¹æ³•ã€‚

### æ·»åŠ è‡ªå®šä¹‰æ•°æ® CustomEvent()

ä¸ºäº†æ·»åŠ æ›´å¤šçš„æ•°æ®åˆ°äº‹ä»¶å¯¹è±¡ï¼Œ[`CustomEvent`](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent)æ¥å£æœ‰ä¸€ä¸ª`detail`å±æ€§å¯ä»¥ä¼ é€’è‡ªå®šä¹‰æ•°æ®ã€‚

æˆ‘ä»¬æ¥è¯•ä¸€è¯•ï¼š
```js
var event = new CustomEvent('build', { detail: 'xiaohesong' });
```

è¿™æ ·å°±å¯ä»¥è®¿é—®ä¸€äº›å…¶ä»–æ•°æ®äº†ã€‚
```js
function eventHandler(e) {
  console.log('The name is: ' + e.detail);
}
```
### è€å¼çš„æ–¹æ³•

è€çš„åˆ›å»ºäº‹ä»¶çš„æ–¹æ³•æ˜¯å—Javaå¯å‘äº§ç”Ÿçš„APIã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:

```js
// åˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œæ³¨æ„ï¼š`Event`è¿™ä¸ªå‚æ•°æ˜¯.
var event = document.createEvent('Event');

// å®šä¹‰äº‹ä»¶çš„åå­—æ˜¯ 'build'.
event.initEvent('build', true, true);

// ç›‘å¬äº‹ä»¶.
elem.addEventListener('build', function (e) {
  // e.target åŒ¹é…å…ƒç´ 
}, false);

// targetå¯ä»¥æ˜¯ä»»ä½•Elementæˆ–è€…å…¶ä»–çš„EventTarget.
elem.dispatchEvent(event);
```
å¯ä»¥å‘ç°ï¼Œæ¯”è¾ƒå•°å—¦ï¼Œä½†æ˜¯å¦‚æœä½ è¦åšå…¼å®¹ï¼Œä¼¼ä¹åªèƒ½ä½¿ç”¨è¿™ä¸ªæ³•å­ã€‚

å€¼å¾—è¯´ä¸€ä¸‹çš„æ˜¯ï¼Œä¸Šé¢åˆ›å»ºçš„`event`å¯¹è±¡ï¼Œå°±æ˜¯è¢«åˆ›å»ºçš„[`Event`](https://developer.mozilla.org/en-US/docs/Web/API/Event)å¯¹è±¡ã€‚

ç„¶åå¯¹åº”åˆ›å»ºäº‹ä»¶çš„ç±»å‹ï¼Œå°±æ˜¯ä¸Šé¢é‚£ä¸ªæ³¨æ„çš„`'Event'`å‚æ•°ã€‚
```js
var event = document.createEvent(type);
```
`type`æ˜¯è¡¨ç¤ºè¦åˆ›å»ºçš„äº‹ä»¶ç±»å‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¯èƒ½åŒ…å«çš„æœ‰`"UIEvents"`,`"MouseEvents"`, `"MutationEvents"`, å’Œ `"HTMLEvents"`ã€‚


### äº‹ä»¶å†’æ³¡
æœ‰æ—¶å€™æˆ‘ä»¬ä½¿ç”¨äº‹ä»¶å†’æ³¡æ³•åˆ™æ¥å®Œæˆäº‹ä»¶ä»£ç†ã€‚

æ¥çœ‹ä¸€ä¸ªå°ğŸŒ°ï¼š

```html
<form>
  <textarea></textarea>
</form>
```

```js
const form = document.querySelector('form');
const textarea = document.querySelector('textarea');

// åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„äº‹ä»¶ï¼Œå…è®¸å†’æ³¡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä¼ é€’ä»»ä½•æ•°æ®ç»™detailsæ¥å¾—åˆ°ä½ æƒ³è¦çš„ã€‚

const eventAwesome = new CustomEvent('awesome', {
  bubbles: true,
  detail: { text: () => textarea.value }
});

// formå…ƒç´ ç›‘å¬è‡ªå®šä¹‰çš„"awesome"äº‹ä»¶ï¼Œç„¶åè¾“å‡º
form.addEventListener('awesome', e => console.log(e.detail.text()));

// å½“ç”¨æˆ·è¾“å…¥å†…å®¹æ—¶ï¼Œformé‡Œçš„textarea è°ƒåº¦/è§¦å‘(dispatches/triggers)äº‹ä»¶ä»¥è§¦å‘ï¼Œå¹¶å°†è‡ªèº«ç”¨ä½œèµ·ç‚¹
textarea.addEventListener('input', e => e.target.dispatchEvent(eventAwesome));

```

è¿™ä¸ªå°ğŸŒ°å®Œæˆä¸‹æ¥ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ä¹Ÿå¾ˆå®¹æ˜“è®°ä½çš„ã€‚
### åŠ¨æ€åˆ›å»ºå’Œåˆ†æ´¾äº‹ä»¶

å…ƒç´ å¯ä»¥ç›‘å¬è¿˜æ²¡æœ‰åˆ›å»ºçš„äº‹ä»¶ï¼Œæˆ‘ä»¬æ¥ä¸€ç¹ä¸ºå¿«ã€‚

```html
<form>
  <textarea></textarea>
</form>
```

```js
const form = document.querySelector('form');
const textarea = document.querySelector('textarea');

form.addEventListener('awesome', e => console.log(e.detail.text()));

textarea.addEventListener('input', function() {
  // åŠ¨æ€åˆ›å»ºå’Œè°ƒåº¦/è§¦å‘äº‹ä»¶
  // æ³¨æ„:æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨çš„æ˜¯â€å‡½æ•°è¡¨è¾¾å¼â€(è€Œä¸æ˜¯â€œç®­å¤´å‡½æ•°è¡¨è¾¾å¼â€)ï¼Œå› æ­¤â€œthisâ€å°†å¯ä»¥è¡¨ç¤ºæ­¤å…ƒç´ ã€‚
  this.dispatchEvent(new CustomEvent('awesome', { bubbles: true, detail: { text: () => textarea.value } }))
});
```

å¥½å§ï¼Œè¿˜æ˜¯å’Œä¹‹å‰å·®ä¸å¤šæ˜¯ä¸ï¼Œåªæ˜¯æŠŠåˆ›å»ºäº‹ä»¶æ”¾åœ¨äº†`dispatchEvent`ä¸Šé¢è€Œå·²ï¼›

### è§¦å‘å†…ç½®äº‹ä»¶

æ¥å§ï¼Œç›´æ¥çœ‹ä¸€ä¸ªğŸŒ°ï¼Œåƒäº†å®ƒï¼š

```js
function simulateClick() {
  var event = new MouseEvent('click', {
    view: window,
    bubbles: true,
    cancelable: true
  });
  var cb = document.getElementById('checkbox'); 
  var cancelled = !cb.dispatchEvent(event);
  if (cancelled) {
    // A handler called preventDefault.
    alert("cancelled");
  } else {
    // None of the handlers called preventDefault.
    alert("not cancelled");
  }
}
```

> å°é—®ï¼šçœ‹åˆ°ä¸Šé¢å¯¹äº`CustomEvent`ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä»–å¯ä¸å¯ä»¥ä¼ é€’`detail`ï¼Ÿè¯•è¯•å‘—ï¼Ÿç„¶åå‘ç°ï¼Œä¸å¯ä»¥å“¦ã€‚å¥½å§ï¼Œå¦‚æœä½ æœ‰è¿™ä¸ªç–‘é—®ï¼Œé‚£å°±è¯´æ˜ä½ å¿˜äº†ä»”ç»†çœ‹ä¸Šé¢è¯´çš„`CustomEvent`ä¸Šæœ‰ä¸ª`detail`å±æ€§äº†ã€‚

å‚è€ƒï¼š
> [CustomEvent interface](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent)
>
> [Creating and triggering events](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#The_old-fashioned_way)